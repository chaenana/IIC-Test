<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css" />
    <title>Download File</title>
</head>
<body>

    <h1 class="title">AI R&D</h1>

    <!-- 햄버거 메뉴 -->
    <div class="hamburger-menu" onclick="toggleSidebar()">
        <div></div>
        <div></div>
        <div></div>
    </div>

    <!-- 사이드바 -->
    <div id="sidebar" class="sidebar">
        <span class="close-btn" onclick="closeSidebar()">×</span>
        <a href="javascript:void(0);" onclick="window.open('http://172.10.3.141:8188', '_blank')">COMFYUI_ROOM 1</a>
        <a href="javascript:void(0);" onclick="window.open('http://172.10.3.141:8189', '_blank')">COMFYUI_ROOM 2</a>
    </div>

    <!-- 메인 콘텐츠 -->
    <div class="grid-container" id="gridContainer">
        <!-- 컨텐츠는 JavaScript에서 동적으로 생성됨 -->
    </div>

    <!-- 오른쪽에서 밀고 들어오는 패널 -->
    <div id="sidePanel">
        <h2>새로운 화면</h2>
        <p>여기는 오른쪽에서 밀고 들어오는 새로운 div입니다.</p>
        <button class="download_sidePanel" onclick="window.open('http://172.10.0.152:5000/sharing/sXxbg1Ioe','_blank')">
                Download WorkFlow
        </button>
        <button class="close-btn-sidePanel" onclick="closeSidePanel()">닫기</button>
        <img id="sidePanel_img" src="https://via.placeholder.com/600x400" class="sidePanel_Thumbs"> <!-- 이미지 중앙 정렬 -->
        <p class="Description_Detail" id="Description_Detail"></p> <!-- Description을 동적으로 삽입할 부분 -->
    </div>

    <!-- JavaScript로 사이드바 열고 닫기 -->
    <script>
        // CSV 데이터를 담을 배열
        let workflowData = [];

        // CSV 파일을 읽어와서 데이터를 파싱하는 함수
        function loadCSVData() {
            // fetch('https://chaenana.github.io/IIC-Test/Sheet1.csv')  // CSV 파일 경로
            fetch('https://chaenana.github.io/IIC-Test/Sheet1.csv')  // CSV 파일 경로
                .then(response => response.text())
                .then(text => {
                    const rows = text.split('\n');
                    for (let i = 1; i < rows.length; i++) {
                        const columns = rows[i].split(',');
                        if (columns.length >= 3) {
                            workflowData.push({
                                id: columns[0],  // ID (예: workflow1)
                                link: columns[1],  // 이미지 링크
                                description: columns[2]  // Description
                            });
                        }
                    }
                    createContainers(); // CSV 데이터 로드 후 container 생성
                })
                .catch(error => console.error('Error loading CSV data: ', error));
        }

        // Description과 이미지 링크를 업데이트하는 함수
        function loadDescriptionAndImage(workflowId) {
            const workflow = workflowData.find(item => item.id === workflowId);
            if (workflow) {
                // Description 업데이트
                document.getElementById('Description_Detail').innerText = workflow.description;

                // 이미지 업데이트 (sidePanel 및 main grid 내의 이미지)
                document.getElementById('sidePanel_img').src = workflow.link;
            } else {
                document.getElementById('Description_Detail').innerText = 'No description available for this workflow.';
            }
        }

        // 컨테이너 동적 생성
        function createContainers() {
            const gridContainer = document.getElementById('gridContainer');
            gridContainer.innerHTML = '';  // 기존 내용을 지움

            // workflowData 배열의 각 항목을 기반으로 container 생성
            workflowData.forEach(workflow => {
                // div container 생성
                const container = document.createElement('div');
                container.classList.add('container');
                container.id = 'con_' + workflow.id;
                container.onclick = () => openSidePanel(workflow.id);

                // 이미지와 버튼 추가
                const img = document.createElement('img');
                img.src = workflow.link;
                img.alt = workflow.id + " Thumbnail";
                img.id = "img_" + workflow.id;

                const button = document.createElement('button');
                button.innerText = 'Basic Work Flow with MetaData';

                container.appendChild(img);
                container.appendChild(button);

                // gridContainer에 추가
                gridContainer.appendChild(container);
            });
        }

        // Description을 로드하는 함수
        function openSidePanel(workflowId) {
            document.getElementById('sidePanel').classList.add('open');
            loadDescriptionAndImage(workflowId);  // ID에 맞는 Description과 이미지를 로드
        }

        // 오른쪽에서 밀고 들어오는 패널 닫기
        function closeSidePanel() {
            document.getElementById('sidePanel').classList.remove('open');
        }

        // 사이드바 열기
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const gridContainer = document.querySelector('.grid-container');
            if (sidebar.style.left === '0px') {
                sidebar.style.left = '-250px'; // 사이드바 닫기
                gridContainer.style.marginLeft = '0'; // 그리드 원위치
            } else {
                sidebar.style.left = '0'; // 사이드바 열기
                gridContainer.style.marginLeft = '250px'; // 그리드 이동
            }
        }

        // 사이드바 닫기 (X 버튼)
        function closeSidebar() {
            document.getElementById('sidebar').style.left = '-250px'; // 사이드바 닫기
            document.querySelector('.grid-container').style.marginLeft = '0'; // 그리드 원위치
        }

        // 페이지 로드 시 CSV 데이터 로드
        window.onload = function() {
            loadCSVData();
        };
    </script>

</body>
</html>
